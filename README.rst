
Mobile Text Tools
=================

Mobile Text Tools is a set of tools to edit translations for ``Android``
and ``IOS`` mobile applications. It provides a data model represented in
``json`` and can read and write different formats.

Features
--------

-  import .csv, .xls, .xlsx, .json
-  export .csv, .json, android resources, ios resoures
-  custom rows format import and export
-  string escape
-  token replacement: you must use the ``{}`` or ``{1}..{n}`` notation
   in source files

CLI
---

::

   $ update_wordings.py --help
   usage: update_wordings.py [-h] [-o [OUT_FILE [OUT_FILE ...]]]
                             [-a ANDROID_RES_DIR] [-i IOS_RES_DIR]
                             [--android-resname ANDROID_RESNAME]
                             [--ios-resname IOS_RESNAME]
                             input_file
   
   Export wordings for Android & IOS.
   
   positional arguments:
     input_file            .csv, .xls, .xlsx, .json formats are supported.
   
   optional arguments:
     -h, --help            show this help message and exit
     -o [OUT_FILE [OUT_FILE ...]], --out-file [OUT_FILE [OUT_FILE ...]]
                           .json or .csv output file path (default: None)
     -a ANDROID_RES_DIR, --android_res_dir ANDROID_RES_DIR
                           resource directory for android strings (default: None)
     -i IOS_RES_DIR, --ios_res_dir IOS_RES_DIR
                           resource directory for android strings (default: None)
     --android-resname ANDROID_RESNAME
                           filename for android resource (default: strings.xml)
     --ios-resname IOS_RESNAME
                           filename for ios resource (default: i18n.strings)
   
To generate translations for android and ios from ``.xlsx`` file :

::

    # python update_wordings.py my_wordings.xlsx -i out/ios -a out/android

To generate translations from json file for android with custom resource
filename :

::

    # python update_wordings.py my_wordings.json -a out/android --android-resname my_strings.xml

Python interface
----------------

.. code:: python

    import mobileStrings

Read :
~~~~~~

Function ``read_file(f)`` from module ``input`` supports ``.xls``,
``.xlsx``, ``.csv``, ``.json`` file formats.

.. code:: python

    languages, wordings = mobileStrings.input.read_file('./test_translations.json')
    print ', '.join(languages)


.. parsed-literal::

    en, fr, de, pt, it, es, nl, zh, ja, pl, pt_BR, ru, id, ko, ar, tr, th, sv


Read custom formats :
~~~~~~~~~~~~~~~~~~~~~

For formats represented as rows like ``.csv`` and ``.xls``, you can
specify columns numbers with ``FormatSpec``

.. code:: python

    specs = mobileStrings.input.FormatSpec(0, 1, 2, 3, 4, bool, bool, {}) # Default format_spec (all params are optional)
    
    languages, wordings = mobileStrings.input.read_file('./test_translations.csv', specs)
    print ', '.join(languages)


.. parsed-literal::

    en, fr, de, pt, it, es, nl, zh, ja, pl, pt_BR, ru, id, ko, ar, tr, th, sv


Query :
~~~~~~~

To search a wording by its key, you can convert the ``list`` of
``Wording`` to a ``dict``

.. code:: python

    # wordings is a list, create a dict to query
    d = dict((w.key,w) for w in wordings)
    print('# keys: ')
    print '\n'.join(d.keys())
    
    welcome_wording = d.get('menu.welcome')
    
    print('\n# ' +welcome_wording.comment+':')
    print welcome_wording.translations.get('fr')
    print welcome_wording.translations.get('de')


.. parsed-literal::

    # keys: 
    menu.home
    menu.contact
    menu.share
    menu.welcome
    menu.news
    menu.share.not.exported
    menu.infos
    comment.generated
    comment.section
    
    # Title on menu header:
    Bienvenue !
    Willkommen!


Write :
~~~~~~~

Writing is very simple : use a ``write_`` function from the ``output``
module. It supports ``Android``, ``IOS``, ``json``, ``csv`` output
formats.

For mobile applications :

.. code:: python

    mobileStrings.output.write_android_strings(languages, wordings, '~/dev/myAndProject/res')
    mobileStrings.output.write_ios_strings(languages, wordings, '~/dev/myIOSProject/res')

Csv example :

.. code:: python

    import cStringIO
    sf = cStringIO.StringIO()
    
    # Write csv in a file-like object, for the first 3 languages only
    mobileStrings.output.write_csv(languages[:3], wordings, sf)
    print sf.getvalue()
    sf.close()


.. parsed-literal::

    key,exportable,is_comment,comment,en,fr,de
    comment.generated,Yes,Yes,Generated by mobile dev tools - Do not modify,,,
    menu.welcome,Yes,,Title on menu header,Welcome!,Bienvenue !,Willkommen!
    menu.home,Yes,,Home item,Home,Accueil,Start
    menu.news,Yes,,News item,News,Actualit√©s,News
    comment.section,Yes,Yes,This is a section,,,
    menu.contact,Yes,,Contact item,Contact,Contact,Kontakt
    menu.infos,Yes,,Information pages item,Info,Infos,Informationen
    menu.share.not.exported,,,Share application item - not exported,Share,Partager,Teilen
    menu.share,Yes,,Share application item,Share,Partager,Teilen
    menu.share,Yes,,Share application item,,Partager,Teilen
    

